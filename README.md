# GatePass: Sistema de Compra e Venda de Ingressos/Produtos

![GatePass Logo](public/images/gate-pass-logo.png) 

## üìÑ Vis√£o Geral do Projeto

O **GatePass** √© um sistema completo e moderno projetado para facilitar a compra e venda de ingressos ou produtos. Ele oferece uma experi√™ncia de usu√°rio intuitiva com um design aprimorado, um controle de estoque robusto com l√≥gica de reserva por tempo e um fluxo de compra seguro e simulado. O projeto foi constru√≠do com foco em boas pr√°ticas de desenvolvimento e arquitetura modular, utilizando **PHP puro** no backend e tecnologias web padr√£o para o frontend, tudo empacotado e orquestrado por **Docker** para um ambiente de desenvolvimento port√°til e eficiente.

## üß∞ Linguagens e Tecnologias Utilizadas

Este projeto foi desenvolvido utilizando as seguintes tecnologias:

* **Linguagens:**
  * PHP 8.1: Para toda a l√≥gica de backend, gerenciamento de sess√µes, intera√ß√£o com o banco de dados e controle de fluxo.
  * HTML: Estrutura√ß√£o das p√°ginas e formul√°rios da interface do usu√°rio.
  * CSS: Estiliza√ß√£o visual (layouts, componentes, responsividade), com uso de vari√°veis CSS para modularidade.
* **Banco de Dados:**
  * MariaDB 10.6: Sistema de gerenciamento de banco de dados relacional para persist√™ncia dos dados da aplica√ß√£o.
* **Orquestra√ß√£o e Ambiente:**
  * Docker: Para criar e gerenciar containers isolados para a aplica√ß√£o PHP e o banco de dados.
  * Docker Compose: Para definir e executar aplica√ß√µes multi-container Docker com um √∫nico comando.
* **Depend√™ncias PHP (via Composer):**
  * Dompdf (`dompdf/dompdf`): Biblioteca essencial para a gera√ß√£o de documentos PDF a partir de HTML, utilizada para os ingressos.

## ‚ú® Funcionalidades Principais

O **GatePass** oferece um conjunto abrangente de funcionalidades, divididas por pap√©is de usu√°rio:

### M√≥dulo de Usu√°rios (Vendedores/Administradores)

* **Autentica√ß√£o Completa:**
  * Cadastro: Cria√ß√£o de novas contas de vendedor (`/public/cadastro_usuario.php`).
  * Login/Logout: Gerenciamento de sess√µes seguras (`/public/login.php`, `/public/logout.php`).
  * Verifica√ß√£o de Sess√£o: Prote√ß√£o de p√°ginas sens√≠veis (`GatePass\Core\Auth`).
* **Gerenciamento de Perfil:**
  * Edi√ß√£o de Perfil: Atualiza√ß√£o de dados pessoais e senha (com valida√ß√£o de senha atual) (`/public/editar_perfil.php`).
  * Exclus√£o de Perfil: Remo√ß√£o definitiva da conta com confirma√ß√£o (`/public/excluir_perfil.php`).
* **Gest√£o de Produtos:**
  * Cadastro de Produtos: Adi√ß√£o de novos produtos/ingressos com detalhes (`/public/cadastrar_produto.php`).
    * Upload de Imagens: Suporte para upload de `Foto de Perfil` e `Foto de Fundo/Banner` do evento (JPG, PNG, GIF), vinculadas ao produto.
  * Visualiza√ß√£o de Produtos: Listagem dos produtos cadastrados pelo pr√≥prio vendedor (`/public/listar_produtos.php`).
  * Edi√ß√£o de Produtos: Modifica√ß√£o de detalhes de produtos existentes (apenas os pr√≥prios) (`/public/editar_produto.php`).
  * Exclus√£o de Produtos: Remo√ß√£o de produtos (apenas os pr√≥prios) (`/public/excluir_produto.php`).
* **Painel Administrativo:**
  * Dashboard do Vendedor: P√°gina centralizada (`/public/dashboard_vendedor.php`) para acesso r√°pido a todas as funcionalidades de gest√£o.
  * Listagem de Usu√°rios: Vis√£o geral de outros usu√°rios do sistema (`/public/listar_usuarios.php`).

### M√≥dulo de Clientes (Compradores)

* **Autentica√ß√£o Independente:**
  * Cadastro: Clientes podem se auto-cadastrar para criar sua conta (`/public/cadastro_cliente.php`).
  * Login/Logout: Gerenciamento de sess√µes espec√≠ficas para clientes (`/public/login_cliente.php`, `/public/logout_cliente.php`).
* **Navega√ß√£o e Compra:**
  * Vitrine de Produtos: P√°gina p√∫blica e responsiva (`/public/listar_produtos_publico.php`) para visualizar todos os ingressos/produtos dispon√≠veis.
    * Layout Moderno: Apresenta os produtos em um layout de cards visualmente aprimorado, com imagens e informa√ß√µes claras.
  * Detalhes do Produto: P√°gina dedicada para informa√ß√µes aprofundadas do ingresso (`/public/detalhes_produto.php`).
    * Reserva de Estoque (2 Minutos): Quando a √∫ltima unidade de um produto √© visualizada por um cliente logado, ela √© automaticamente reservada por 2 minutos.
    * Gerenciamento Autom√°tico: Durante a reserva, o item fica indispon√≠vel para outros; a reserva expira e o item √© liberado se a compra n√£o for conclu√≠da no prazo.
    * Status Claros: Exibe status como "Reservado para voc√™", "Temporariamente reservado", ou "Esgotado".
  * Sistema de Carrinho de Compras:
    * Adicionar ao Carrinho: Inclus√£o de produtos (com quantidade) no carrinho a partir da vitrine ou detalhes.
    * Gerenciar Carrinho: P√°gina dedicada (`/public/ver_carrinho.php`) para visualizar, ajustar quantidades e remover itens.
  * Fluxo de Checkout:
    * P√°gina de resumo do pedido (`/public/checkout.php`) com re-valida√ß√£o de estoque final.
    * Sele√ß√£o de M√©todo de Pagamento: Op√ß√µes simuladas de PIX, Boleto e Cart√£o de Cr√©dito.
  * Finaliza√ß√£o da Compra: Processamento seguro da transa√ß√£o (`/public/processar_compra.php`), com decremento de estoque e registro de m√∫ltiplas compras via transa√ß√µes at√¥micas.
* **Hist√≥rico de Compras:**
  * Minhas Compras: Clientes podem visualizar um hist√≥rico detalhado de suas compras (`/public/minhas_compras.php`).
  * Gera√ß√£o de Ingresso em PDF: Para cada compra, √© poss√≠vel gerar um ingresso em formato PDF com layout padr√£o, utilizando imagens do produto e dados do cliente (incluindo CPF).

### Medidas de Seguran√ßa Implementadas

* **Sanitiza√ß√£o de Dados:** Uso rigoroso de `htmlspecialchars()` e `filter_var()` em todas as entradas de usu√°rio e sa√≠das HTML para prevenir ataques de Cross-Site Scripting (XSS).
* **Preven√ß√£o de SQL Injection:** Todas as intera√ß√µes com o banco de dados utilizam Prepared Statements (consultas preparadas) atrav√©s da extens√£o PDO.
* **Hashing de Senhas:** Senhas dos usu√°rios e clientes s√£o armazenadas de forma segura com `Bcrypt`.
* **Gerenciamento Seguro de Arquivos:** A classe `GatePass\Utils\FileUpload` valida o tipo e tamanho dos arquivos de imagem, gera nomes √∫nicos e move os arquivos de forma segura.
* **Controle de Acesso por Sess√£o:** P√°ginas protegidas e a√ß√µes sens√≠veis verificam a autentica√ß√£o e permiss√µes do usu√°rio logado.

## ‚öôÔ∏è Como Instalar e Rodar Localmente

Siga estas instru√ß√µes passo a passo para configurar e executar o projeto em seu ambiente de desenvolvimento.

### Pr√©-requisitos

* [Docker Desktop](https://www.docker.com/products/docker-desktop) (que inclui Docker Engine e Docker Compose) instalado em seu sistema operacional (Windows, macOS, Linux).

### Passos para Configura√ß√£o e Execu√ß√£o

1.  **Clone o Reposit√≥rio:**
    Abra seu terminal ou prompt de comando, navegue at√© o diret√≥rio onde deseja armazenar o projeto e clone o reposit√≥rio:
    ```bash
    git clone https://github.com/JonathanBufon/gatepass.git GatePass
    cd GatePass

    ```

2.  **Execute o Script de Setup Automatizado:**
    Este script `setup.sh` automatiza todos os passos iniciais de configura√ß√£o: cria√ß√£o de diret√≥rios, ajuste de permiss√µes, instala√ß√£o de depend√™ncias Composer e inicializa√ß√£o dos servi√ßos Docker (aplica√ß√£o PHP e banco de dados MariaDB).
    ```bash
    # Concede permiss√£o de execu√ß√£o ao script
    chmod +x setup.sh

    # Executa o script de setup
    ./setup.sh
    ```
    *Siga as instru√ß√µes exibidas no terminal durante a execu√ß√£o do script.* Ele far√° o seguinte:
    * Criar√° a pasta `public/uploads/produtos` e definir√° as permiss√µes necess√°rias.
    * Instalar√° as depend√™ncias PHP (incluindo Dompdf e as extens√µes PHP necess√°rias) via Composer em um container Docker.
    * Construir√° as imagens Docker e iniciar√° os containers PHP (Apache) e MariaDB.
    * Na **primeira execu√ß√£o**, o banco de dados (`gatepass_db`) ser√° inicializado e todas as tabelas (definidas em `db/schema.sql`) ser√£o criadas.

### Solu√ß√£o de Problemas: Configura√ß√£o Manual (Fallback)

Caso o script `setup.sh` falhe durante a execu√ß√£o, voc√™ pode tentar realizar os passos manualmente. **Isso √© recomendado apenas se voc√™ encontrar erros no script automatizado.**

1.  **Crie as Pastas de Uploads e Ajuste Permiss√µes:**
    ```bash
    mkdir -p public/uploads/produtos
    chmod -R 777 public/uploads # ATEN√á√ÉO: Permiss√£o 777 √© para desenvolvimento/teste.
    ```

2.  **Instale as Depend√™ncias do Composer:**
    ```bash
    docker run --rm -v "$(pwd)":/app composer/composer install
    ```
    *Se voc√™ precisar atualizar depend√™ncias ou o `composer.lock` estiver fora de sincronia, use `docker run --rm -v "$(pwd)":/app composer/composer update`*.

3.  **Inicie os Servi√ßos Docker:**
    ```bash
    docker compose up --build -d
    ```
    *Este comando ir√° construir suas imagens Docker e iniciar os containers. Na primeira vez, ele tamb√©m inicializar√° seu banco de dados via `db/schema.sql`.*

### Finaliza√ß√£o

1.  **Verifique o Status dos Containers:**
    Para confirmar que todos os servi√ßos est√£o em execu√ß√£o ap√≥s a configura√ß√£o (automatizada ou manual):
    ```bash
    docker compose ps
    ```
    Voc√™ dever√° ver `gatepass_app_php` e `gatepass_db_mariadb` com status `running`.

2.  **Acesse a Aplica√ß√£o no Navegador:**
    Com os containers rodando, abra seu navegador web e acesse o endere√ßo:
    ```
    http://localhost/public/
    ```
    Voc√™ ser√° automaticamente redirecionado para a p√°gina de listagem p√∫blica de produtos, pronto para come√ßar a usar o **GatePass**.

## üìñ Como Usar o Sistema

### Para Compradores (Clientes)

1.  **Navegar e Adicionar ao Carrinho:**
    * Acesse `http://localhost/public/` para explorar os produtos.
    * Use o bot√£o "Adicionar ao Carrinho" nos cards de produto ou na p√°gina de detalhes.
2.  **Ver e Gerenciar Carrinho:**
    * No cabe√ßalho, clique em "Ver Carrinho" (exibe a quantidade de itens no carrinho) para acessar a p√°gina de gerenciamento (`/public/ver_carrinho.php`).
    * Nesta p√°gina, voc√™ pode ajustar a quantidade de itens ou remover itens do carrinho.
3.  **Cadastro ou Login de Cliente:**
    * Se voc√™ ainda n√£o tem uma conta de cliente, pode se cadastrar via o link "Cadastre-se Cliente" no cabe√ßalho ou durante o checkout.
    * Se j√° tem uma conta, use o link "Login Cliente" no cabe√ßalho.
4.  **Finalizar Compra:**
    * No carrinho, clique em "Finalizar Compra" para ir √† p√°gina de checkout (`/public/checkout.php`).
    * Revise o resumo do pedido e escolha o m√©todo de pagamento (PIX, Boleto ou Cart√£o - *lembre-se, a transa√ß√£o √© simulada*).
    * Clique em "Confirmar Pagamento".
5.  **Minhas Compras e Ingresso PDF:**
    * Ap√≥s a compra bem-sucedida, voc√™ ser√° redirecionado para "Minhas Compras" (`/public/minhas_compras.php`).
    * Aqui, voc√™ ver√° o hist√≥rico de suas compras. Ao lado de cada compra, haver√° um bot√£o "Gerar Ingresso" para baixar o ingresso correspondente em formato PDF.

### Para Vendedores (Usu√°rios)

1.  **Login de Vendedor:**
    * Na vitrine principal (`http://localhost/public/`), clique em "Acesso Vendedor" no cabe√ßalho.
2.  **Cadastro de Usu√°rio (Opcional):**
    * Se ainda n√£o tem uma conta de vendedor, use o link "Cadastre-se aqui" na p√°gina de login de vendedor (`/public/login.php`).
3.  **Acessar Painel do Vendedor:**
    * Ap√≥s o login como vendedor, voc√™ ser√° redirecionado para o `Painel do Vendedor` (`/public/dashboard_vendedor.php`).
4.  **Gerenciar Produtos:**
    * No painel, voc√™ pode "Cadastrar Novo Produto" (incluindo upload de fotos de perfil e banner!) e ver "Meus Produtos" para editar ou excluir os produtos que voc√™ cadastrou.
5.  **Outras A√ß√µes:**
    * "Editar Meu Perfil": Para gerenciar sua conta de vendedor.
    * "Listar Usu√°rios": Para ver uma lista de todos os usu√°rios do sistema.

## üìÅ Estrutura do Projeto

```
GatePass/
‚îú‚îÄ‚îÄ public/                    # Arquivos acess√≠veis via web (HTML, CSS, JS, imagens e scripts PHP)
‚îÇ   ‚îú‚îÄ‚îÄ index.php              # P√°gina inicial que redireciona para a vitrine
‚îÇ   ‚îú‚îÄ‚îÄ css/                   # Estilos CSS globais (ex: style.css)
‚îÇ   ‚îú‚îÄ‚îÄ images/                # Imagens est√°ticas (logo, √≠cones, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ uploads/               # Uploads de usu√°rios
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ produtos/          # Imagens espec√≠ficas dos produtos
‚îÇ   ‚îî‚îÄ‚îÄ *.php                  # Scripts p√∫blicos (login, cadastro, vitrine, carrinho, checkout, etc.)
‚îÇ
‚îú‚îÄ‚îÄ src/                       # C√≥digo-fonte da aplica√ß√£o (l√≥gica PHP)
‚îÇ   ‚îú‚îÄ‚îÄ Core/                  # Classes centrais (conex√£o com o banco, autentica√ß√£o)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Database.php       # Conex√£o PDO com MariaDB
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Auth.php           # Gerenciamento de sess√µes e autentica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ Models/                # Modelos de dados (intera√ß√£o com o banco)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Usuario.php        # Modelo para vendedores
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Cliente.php        # Modelo para clientes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Produto.php        # Modelo para produtos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Compra.php         # Modelo para compras
‚îÇ   ‚îî‚îÄ‚îÄ Utils/                 # Utilit√°rios diversos
‚îÇ       ‚îî‚îÄ‚îÄ FileUpload.php     # Classe para upload seguro de imagens
‚îÇ
‚îú‚îÄ‚îÄ db/                        # Scripts SQL e estrutura do banco
‚îÇ   ‚îî‚îÄ‚îÄ schema.sql             # Defini√ß√£o das tabelas do banco (MariaDB)
‚îÇ
‚îú‚îÄ‚îÄ vendor/                    # Depend√™ncias instaladas via Composer (ex: dompdf)
‚îÇ
‚îú‚îÄ‚îÄ composer.json              # Lista de depend√™ncias PHP do projeto
‚îú‚îÄ‚îÄ composer.lock              # Vers√µes travadas das depend√™ncias
‚îÇ
‚îú‚îÄ‚îÄ Dockerfile                 # Define o ambiente Docker da aplica√ß√£o PHP
‚îú‚îÄ‚îÄ docker-compose.yml         # Orquestra√ß√£o Docker (PHP + MariaDB)
‚îú‚îÄ‚îÄ setup.sh                   # Script de instala√ß√£o e configura√ß√£o automatizada
```


## üóÑÔ∏è Estrutura do Banco de Dados

O banco de dados `gatepass_db` √© implementado em MariaDB e possui as seguintes tabelas principais:

* **`usuarios`**: Armazena as informa√ß√µes dos usu√°rios (vendedores/administradores) do sistema.
    * `id_usuario` (PK, INT, Auto-Increment)
    * `nome` (VARCHAR)
    * `email` (VARCHAR, UNIQUE)
    * `senha` (VARCHAR, hashed)
    * `data_cadastro` (TIMESTAMP)
* **`clientes`**: Armazena as informa√ß√µes dos clientes (compradores) que realizam as compras.
    * `id_cliente` (PK, INT, Auto-Increment)
    * `nome` (VARCHAR)
    * `email` (VARCHAR, UNIQUE)
    * `senha` (VARCHAR, hashed)
    * `cpf` (VARCHAR, UNIQUE, NULLable)
    * `telefone` (VARCHAR, NULLable)
    * `data_cadastro` (TIMESTAMP)
* **`produtos`**: Cont√©m os detalhes dos produtos/ingressos dispon√≠veis para venda.
    * `id_produto` (PK, INT, Auto-Increment)
    * `id_usuario` (FK para `usuarios.id_usuario` - vendedor que cadastrou)
    * `nome` (VARCHAR)
    * `descricao` (TEXT, NULLable)
    * `preco` (DECIMAL)
    * `quantidade_total` (INT)
    * `quantidade_disponivel` (INT)
    * `quantidade_reservada` (INT)
    * `data_reserva` (TIMESTAMP, NULLable)
    * `reservado_por_cliente_id` (FK para `clientes.id_cliente`, NULLable - cliente que reservou)
    * `url_foto_perfil` (VARCHAR, NULLable)
    * `url_foto_fundo` (VARCHAR, NULLable)
    * `data_cadastro` (TIMESTAMP)
* **`compras`**: Registra cada transa√ß√£o de compra.
    * `id_compra` (PK, INT, Auto-Increment)
    * `id_produto` (FK para `produtos.id_produto`)
    * `id_cliente` (FK para `clientes.id_cliente`)
    * `id_usuario_vendedor` (FK para `usuarios.id_usuario` - vendedor do produto)
    * `quantidade_comprada` (INT)
    * `valor_total` (DECIMAL)
    * `metodo_pagamento` (VARCHAR)
    * `data_compra` (TIMESTAMP)

## ü§ù Como Contribuir

Contribui√ß√µes s√£o muito bem-vindas! Se voc√™ deseja colaborar com o projeto:

1.  **Fa√ßa um Fork** do reposit√≥rio.
2.  **Crie uma nova Branch** para sua feature (`git checkout -b feature/minha-nova-funcionalidade`).
3.  **Implemente suas altera√ß√µes** e certifique-se de que o c√≥digo segue os padr√µes do projeto.
4.  **Fa√ßa Testes** para garantir que suas mudan√ßas n√£o introduzam bugs e funcionem conforme o esperado.
5.  **Fa√ßa Commit** de suas mudan√ßas (`git commit -m "feat: Adiciona nova funcionalidade X"`).
6.  **Fa√ßa Push** para a sua Branch (`git push origin feature/minha-nova-funcionalidade`).
7.  **Abra um Pull Request** detalhando as mudan√ßas realizadas.

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a Licen√ßa MIT. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.

---

**Desenvolvido por:**

* **Nome:** Jonathan Bufon
* **Email:** jonathanbufon@gmail.com

---
**Chapec√≥, Santa Catarina, Brasil.**
**Data da Documenta√ß√£o Final:** 26 de Julho de 2025.
=======

# gatepass
Projeto Final do curso DEV Evolution

